name: 'Install a Visual Studio Extension' 
description: 'Download the latest extension version and install in Visual Studio'
inputs:
  packagename: 
    description:  'Package names from the Visual Studio Marketplace URL itemName parameter'
    required: true
    default: ''
runs:
  using: "composite"
  steps:
    - id: vsix
      shell: pwsh
      run: |
        $baseProtocol = "https:"
        $baseHostName = "marketplace.visualstudio.com"
        
        $Uri = "$($baseProtocol)//$($baseHostName)/items?itemName=${{ inputs.packagename }}"
        $VsixLocation = "$($env:Temp)\$([guid]::NewGuid()).vsix"
        
        $VSInstallDir = "C:\Program Files (x86)\Microsoft Visual Studio\Installer\resources\app\ServiceHub\Services\Microsoft.VisualStudio.Setup.Service"
        
        if (-Not $VSInstallDir) {
          Write-Error "Visual Studio InstallDir registry key missing"
          Exit 1
        }